<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="AIQ">
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>redisReplication - MySkill</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">MySkill</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Database <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">GaussDB</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../GaussDB/GaussDB考试认证指南/">GaussDB考试认证指南</a>
</li>
            
<li >
    <a href="../../GaussDB/HCIP-GaussDB-OLTP_V1.0考试大纲/">HCIP-GaussDB-OLTP_V1.0考试大纲</a>
</li>
            
<li >
    <a href="../../GaussDB/HCIP-GaussDB-OLTP_华为数据库高级工程师认证培训/">HCIP-GaussDB-OLTP_华为数据库高级工程师认证培训</a>
</li>
            
<li >
    <a href="../../GaussDB/模拟试卷/">模拟试卷</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Mysql</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../Mysql/Mysql/">Mysql</a>
</li>
            
<li >
    <a href="../../Mysql/Mysql_OCP/">Mysql_OCP</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">basic</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../Mysql/basic/Select/">Select</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">InndbArchitecture</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../Mysql/basic/InndbArchitecture/Untitled/">Untitled</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">SQL</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../Mysql/basic/SQL/Alter_Database/">Alter_Database</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/Alter_View/">Alter_View</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/CreateDatabase/">CreateDatabase</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/CreateIndex/">CreateIndex</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/CreateTable/">CreateTable</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/CreateView/">CreateView</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/Create_Table_2/">Create_Table_2</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/Cursor/">Cursor</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/Delete/">Delete</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/Funtion/">Funtion</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/Instert&Update/">Instert&Update</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/MySQL指定账号加密方式的方法/">MySQL指定账号加密方式的方法</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/Select/">Select</a>
</li>
            
<li >
    <a href="../../Mysql/basic/SQL/Untitled/">Untitled</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Oracle</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../Oracle/Database_Architacture/">Database_Architacture</a>
</li>
            
<li >
    <a href="../../Oracle/Oracle/">Oracle</a>
</li>
            
<li >
    <a href="../../Oracle/Rman/">Rman</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Rac</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../Oracle/Rac/GridInstall/">GridInstall</a>
</li>
            
<li >
    <a href="../../Oracle/Rac/RACBuild/">RACBuild</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">ASM</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../Oracle/Rac/ASM/ASM创建失败分析/">ASM创建失败分析</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Life <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../Life/日本使馆各职能部门/">日本使馆各职能部门</a>
</li>
                                    
<li >
    <a href="../../../Life/确定一个可操作的目标/">确定一个可操作的目标</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">GeneralEducation</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Wine</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../Life/GeneralEducation/Wine/酒/">酒</a>
</li>
            
<li >
    <a href="../../../Life/GeneralEducation/Wine/酒的误区/">酒的误区</a>
</li>
            
<li >
    <a href="../../../Life/GeneralEducation/Wine/酒精中毒/">酒精中毒</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">define</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../Life/GeneralEducation/Wine/define/乙醛脱氢酶/">乙醛脱氢酶</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">梦呓</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../Life/梦呓/模板/">模板</a>
</li>
            
<li >
    <a href="../../../Life/梦呓/模板_(copy)/">模板_(copy)</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Linux <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">BasicCommand</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../Linux/BasicCommand/fdisk/">fdisk</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../../about/">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#1">1. 环境</a></li>
        <li class="main "><a href="#2">2. 编译安装</a></li>
        <li class="main "><a href="#3">3. 集群安装</a></li>
            <li><a href="#31">3.1目录</a></li>
            <li><a href="#32">3.2 配置文件</a></li>
            <li><a href="#33-redis">3.3 启动redis</a></li>
            <li><a href="#34">3.4 创建集群</a></li>
        <li class="main "><a href="#4">4. 集群验证</a></li>
        <li class="main "><a href="#5">5. 关闭集群</a></li>
        <li class="main "><a href="#6">6. 检查集群状态</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<div class="toc">
<ul>
<li><a href="#1">1. 环境</a></li>
<li><a href="#2">2. 编译安装</a></li>
<li><a href="#3">3. 集群安装</a><ul>
<li><a href="#31">3.1目录</a></li>
<li><a href="#32">3.2 配置文件</a></li>
<li><a href="#33-redis">3.3 启动redis</a></li>
<li><a href="#34">3.4 创建集群</a><ul>
<li><a href="#341-help">3.4.1 寻找help</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#4">4. 集群验证</a></li>
<li><a href="#5">5. 关闭集群</a></li>
<li><a href="#6">6. 检查集群状态</a></li>
</ul>
</div>
<h2 id="1">1. 环境</h2>
<ol>
<li>主机(单机演示)</li>
</ol>
<h2 id="2">2. 编译安装</h2>
<pre><code class="shell">tar -xf redis-5.0.9.tar.gz 
cd /RACSoftwares/text/redis
cp -rp redis-5.0.9 /usr/local/
#链接
cd /usr/local/
ln -s redis-5.0.9/ redis
cd redis 
 make -j4&amp;&amp; make install 

</code></pre>

<p>just like that:</p>
<pre><code class="shell">[root@rac01 redis]# make install 
cd src &amp;&amp; make install
make[1]: Entering directory `/usr/local/redis-5.0.9/src'

Hint: It's a good idea to run 'make test' ;)

    INSTALL install
    INSTALL install
    INSTALL install
    INSTALL install
    INSTALL install
make[1]: Leaving directory `/usr/local/redis-5.0.9/src'

</code></pre>

<h2 id="3">3. 集群安装</h2>
<h3 id="31">3.1目录</h3>
<pre><code class="shell">mkdir -p /DB/czqapp/redisCluster/{7000..7009}/{logs,data}
</code></pre>

<h3 id="32">3.2 配置文件</h3>
<pre><code class="shell">for n in {7000..7009}
do
cat &gt;/DB/czqapp/redisCluster/$n/redis.conf&lt;&lt;eof
#port 
port $n
#bind IP :default 127.0.0.1,if localhost , it must be only one node 
#多集群在本地时，需要修改为具体的IP，不能用127.。或者0.0.
bind 192.168.6.22
#redis 是否启用守护进程后台运行。
daemonize yes
#pidfile 
pidfile /DB/czqapp/redisCluster/$n/logs/$n.pid
#open cluster 
cluster-enabled yes 
#集群文件的配置，配置文件首次启动自动生成7000.。。
cluster-config-file nodes_$n.conf
#request time out 15s can define
cluster-node-timeout 15000
#aof日志开户在需要就开户，作用：用于记录操作的每条日志
appendonly yes 

eof
done 
</code></pre>

<h3 id="33-redis">3.3 启动redis</h3>
<pre><code class="shell">for n in {7000..7009}
do
/usr/local/redis-5.0.9/src/redis-server /DB/czqapp/redisCluster/$n/redis.conf
done 
</code></pre>

<p>just like this </p>
<pre><code class="shell">for n in {7000..7009}
&gt; do
&gt; /usr/local/redis-5.0.9/src/redis-server /DB/czqapp/redisCluster/$n/redis.conf
&gt; done 
7688:C 03 Sep 2020 22:51:57.499 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7688:C 03 Sep 2020 22:51:57.500 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7688, just started
7688:C 03 Sep 2020 22:51:57.500 # Configuration loaded
7690:C 03 Sep 2020 22:51:57.513 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7690:C 03 Sep 2020 22:51:57.513 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7690, just started
7690:C 03 Sep 2020 22:51:57.513 # Configuration loaded
7692:C 03 Sep 2020 22:51:57.532 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7692:C 03 Sep 2020 22:51:57.532 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7692, just started
7692:C 03 Sep 2020 22:51:57.532 # Configuration loaded
7697:C 03 Sep 2020 22:51:57.556 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7697:C 03 Sep 2020 22:51:57.556 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7697, just started
7697:C 03 Sep 2020 22:51:57.556 # Configuration loaded
7705:C 03 Sep 2020 22:51:57.569 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7705:C 03 Sep 2020 22:51:57.569 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7705, just started
7705:C 03 Sep 2020 22:51:57.569 # Configuration loaded
7710:C 03 Sep 2020 22:51:57.581 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7710:C 03 Sep 2020 22:51:57.581 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7710, just started
7710:C 03 Sep 2020 22:51:57.581 # Configuration loaded
7715:C 03 Sep 2020 22:51:57.595 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7715:C 03 Sep 2020 22:51:57.595 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7715, just started
7715:C 03 Sep 2020 22:51:57.595 # Configuration loaded
7720:C 03 Sep 2020 22:51:57.611 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7720:C 03 Sep 2020 22:51:57.611 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7720, just started
7720:C 03 Sep 2020 22:51:57.611 # Configuration loaded
7725:C 03 Sep 2020 22:51:57.628 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7725:C 03 Sep 2020 22:51:57.628 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7725, just started
7725:C 03 Sep 2020 22:51:57.629 # Configuration loaded
7730:C 03 Sep 2020 22:51:57.650 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
7730:C 03 Sep 2020 22:51:57.650 # Redis version=5.0.9, bits=64, commit=00000000, modified=0, pid=7730, just started
7730:C 03 Sep 2020 22:51:57.650 # Configuration loaded

</code></pre>

<p>check </p>
<pre><code class="shell">[root@mysql redis]# ps -ef |grep redis 
root      7689     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7000 [cluster]
root      7691     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7001 [cluster]
root      7696     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7002 [cluster]
root      7704     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7003 [cluster]
root      7709     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7004 [cluster]
root      7711     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7005 [cluster]
root      7716     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7006 [cluster]
root      7721     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7007 [cluster]
root      7726     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7008 [cluster]
root      7731     1  0 22:51 ?        00:00:00 /usr/local/redis-5.0.9/src/redis-server 192.168.6.22:7009 [cluster]
root      7941  1961  0 22:52 pts/0    00:00:00 grep --color=auto redis

</code></pre>

<p>check port </p>
<pre><code class="shell">[root@mysql redis]# ss -atp |grep redis
LISTEN     0      128          192.168.6.22:afs3-fileserver                  *:*        users:((&quot;redis-server&quot;,7689,6))
LISTEN     0      128          192.168.6.22:afs3-callback                  *:*        users:((&quot;redis-server&quot;,7691,6))
LISTEN     0      128          192.168.6.22:afs3-prserver                  *:*        users:((&quot;redis-server&quot;,7696,6))
LISTEN     0      128          192.168.6.22:afs3-vlserver                  *:*        users:((&quot;redis-server&quot;,7704,6))
LISTEN     0      128          192.168.6.22:afs3-kaserver                  *:*        users:((&quot;redis-server&quot;,7709,6))
LISTEN     0      128          192.168.6.22:afs3-volser                  *:*        users:((&quot;redis-server&quot;,7711,6))
LISTEN     0      128          192.168.6.22:afs3-errors                  *:*        users:((&quot;redis-server&quot;,7716,6))
LISTEN     0      128          192.168.6.22:afs3-bos                  *:*        users:((&quot;redis-server&quot;,7721,6))
LISTEN     0      128          192.168.6.22:afs3-update                  *:*        users:((&quot;redis-server&quot;,7726,6))
LISTEN     0      128          192.168.6.22:afs3-rmtsys                  *:*        users:((&quot;redis-server&quot;,7731,6))
LISTEN     0      128          192.168.6.22:17000                    *:*        users:((&quot;redis-server&quot;,7689,9))
LISTEN     0      128          192.168.6.22:17001                    *:*        users:((&quot;redis-server&quot;,7691,9))
LISTEN     0      128          192.168.6.22:17002                    *:*        users:((&quot;redis-server&quot;,7696,9))
LISTEN     0      128          192.168.6.22:17003                    *:*        users:((&quot;redis-server&quot;,7704,9))
LISTEN     0      128          192.168.6.22:17004                    *:*        users:((&quot;redis-server&quot;,7709,9))
LISTEN     0      128          192.168.6.22:17005                    *:*        users:((&quot;redis-server&quot;,7711,9))
LISTEN     0      128          192.168.6.22:17006                    *:*        users:((&quot;redis-server&quot;,7716,9))
LISTEN     0      128          192.168.6.22:17007                    *:*        users:((&quot;redis-server&quot;,7721,9))
LISTEN     0      128          192.168.6.22:17008                    *:*        users:((&quot;redis-server&quot;,7726,9))
LISTEN     0      128          192.168.6.22:17009                    *:*        users:((&quot;redis-server&quot;,7731,9))

</code></pre>

<h3 id="34">3.4 创建集群</h3>
<p><code>redis-cli --cluster create {ip:port ip:port ...} --cluster-replicas 1</code></p>
<pre><code class="shell">for n in {7000..7009}
do
#echo -n &quot;192.168.6.22:$n &quot;
echo &quot;192.168.6.22:$n \ &quot;
done 

/usr/local/redis/src/redis-cli --cluster create \
192.168.6.22:7000 \
192.168.6.22:7001 \
192.168.6.22:7002 \
192.168.6.22:7003 \
192.168.6.22:7004 \
192.168.6.22:7005 \
192.168.6.22:7006 \
192.168.6.22:7007 \
192.168.6.22:7008 \
192.168.6.22:7009 --cluster-replicas 1 

</code></pre>

<p>like this </p>
<pre><code class="shell">[root@mysql redis]# /usr/local/redis/src/redis-cli --cluster create \
&gt; 192.168.6.22:7000 \
&gt; 192.168.6.22:7001 \
&gt; 192.168.6.22:7002 \
&gt; 192.168.6.22:7003 \
&gt; 192.168.6.22:7004 \
&gt; 192.168.6.22:7005 \
&gt; 192.168.6.22:7006 \
&gt; 192.168.6.22:7007 \
&gt; 192.168.6.22:7008 \
&gt; 192.168.6.22:7009 --cluster-replicas 1 
&gt;&gt;&gt; Performing hash slots allocation on 10 nodes...
Master[0] -&gt; Slots 0 - 3276
Master[1] -&gt; Slots 3277 - 6553
Master[2] -&gt; Slots 6554 - 9829
Master[3] -&gt; Slots 9830 - 13106
Master[4] -&gt; Slots 13107 - 16383
Adding replica 192.168.6.22:7006 to 192.168.6.22:7000
Adding replica 192.168.6.22:7007 to 192.168.6.22:7001
Adding replica 192.168.6.22:7008 to 192.168.6.22:7002
Adding replica 192.168.6.22:7009 to 192.168.6.22:7003
Adding replica 192.168.6.22:7005 to 192.168.6.22:7004
&gt;&gt;&gt; Trying to optimize slaves allocation for anti-affinity
[WARNING] Some slaves are in the same host as their master
M: 8502488405b28ab3b27a758e42a2a7d9da48ba7e 192.168.6.22:7000
   slots:[0-3276] (3277 slots) master
M: e3667d6d0198b6752e3cb3d6b871cc33e6412b1b 192.168.6.22:7001
   slots:[3277-6553] (3277 slots) master
M: 8968c72d7e5fb74b613aa88b84c13b1a3f44c962 192.168.6.22:7002
   slots:[6554-9829] (3276 slots) master
M: 6bda2655347d4b1c8c36c1ed6db5a87182fe2ff4 192.168.6.22:7003
   slots:[9830-13106] (3277 slots) master
M: 0141741ad8c2e10ea9202b658b3ac056d8968306 192.168.6.22:7004
   slots:[13107-16383] (3277 slots) master
S: f461a834fbdb5672bdc42ffbc8ace4b3c2e792f1 192.168.6.22:7005
   replicates 6bda2655347d4b1c8c36c1ed6db5a87182fe2ff4
S: 01d2e5071b46238852c787f4332ab202af6083d7 192.168.6.22:7006
   replicates 8502488405b28ab3b27a758e42a2a7d9da48ba7e
S: c96310489b156de259ff63a2d86963250e5c9c78 192.168.6.22:7007
   replicates 0141741ad8c2e10ea9202b658b3ac056d8968306
S: a4fa88c4b68e71ece93301e9ece010ea0409a030 192.168.6.22:7008
   replicates 8968c72d7e5fb74b613aa88b84c13b1a3f44c962
S: a9deae248772d6f2a5394ec13ef400fc8677a06c 192.168.6.22:7009
   replicates e3667d6d0198b6752e3cb3d6b871cc33e6412b1b
Can I set the above configuration? (type 'yes' to accept): yes
&gt;&gt;&gt; Nodes configuration updated
&gt;&gt;&gt; Assign a different config epoch to each node
&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster
Waiting for the cluster to join
...........
&gt;&gt;&gt; Performing Cluster Check (using node 192.168.6.22:7000)
M: 8502488405b28ab3b27a758e42a2a7d9da48ba7e 192.168.6.22:7000
   slots:[0-3276] (3277 slots) master
   1 additional replica(s)
S: a4fa88c4b68e71ece93301e9ece010ea0409a030 192.168.6.22:7008
   slots: (0 slots) slave
   replicates 8968c72d7e5fb74b613aa88b84c13b1a3f44c962
M: 8968c72d7e5fb74b613aa88b84c13b1a3f44c962 192.168.6.22:7002
   slots:[6554-9829] (3276 slots) master
   1 additional replica(s)
M: e3667d6d0198b6752e3cb3d6b871cc33e6412b1b 192.168.6.22:7001
   slots:[3277-6553] (3277 slots) master
   1 additional replica(s)
M: 6bda2655347d4b1c8c36c1ed6db5a87182fe2ff4 192.168.6.22:7003
   slots:[9830-13106] (3277 slots) master
   1 additional replica(s)
S: a9deae248772d6f2a5394ec13ef400fc8677a06c 192.168.6.22:7009
   slots: (0 slots) slave
   replicates e3667d6d0198b6752e3cb3d6b871cc33e6412b1b
S: 01d2e5071b46238852c787f4332ab202af6083d7 192.168.6.22:7006
   slots: (0 slots) slave
   replicates 8502488405b28ab3b27a758e42a2a7d9da48ba7e
S: f461a834fbdb5672bdc42ffbc8ace4b3c2e792f1 192.168.6.22:7005
   slots: (0 slots) slave
   replicates 6bda2655347d4b1c8c36c1ed6db5a87182fe2ff4
S: c96310489b156de259ff63a2d86963250e5c9c78 192.168.6.22:7007
   slots: (0 slots) slave
   replicates 0141741ad8c2e10ea9202b658b3ac056d8968306
M: 0141741ad8c2e10ea9202b658b3ac056d8968306 192.168.6.22:7004
   slots:[13107-16383] (3277 slots) master
   1 additional replica(s)
[OK] All nodes agree about slots configuration.
&gt;&gt;&gt; Check for open slots...
&gt;&gt;&gt; Check slots coverage...
[OK] All 16384 slots covered.

</code></pre>

<h4 id="341-help">3.4.1 寻找help</h4>
<pre><code class="shell">1. 寻找一层帮忙
redis-cli -h 
2. 建议子命令的帮助
redis-cli --cluster help
3. 子子命令的可加入参数。create 除了第一行可以加入host1:port1，还可以通过第二行加入--cluster-replicas 1
#   redis-cli --cluster help 
Cluster Manager Commands:
  create         host1:port1 ... hostN:portN
                 --cluster-replicas &lt;arg&gt;
  check          host:port
                 --cluster-search-multiple-owners
  info           host:port


</code></pre>

<h2 id="4">4. 集群验证</h2>
<p>4.1 连接redis : <code>redis-cli -h ${host} -p ${port} -c</code></p>
<p>-c 生效集群模式</p>
<pre><code class="shell">[root@mysql redis]# redis-cli -h 192.168.6.22 -p 7009 -c 
192.168.6.22:7009&gt; set name czqnubilitly 
-&gt; Redirected to slot [5798] located at 192.168.6.22:7001
OK
192.168.6.22:7001&gt; get name 
&quot;czqnubilitly&quot;
192.168.6.22:7001&gt; exit

#####check
[root@mysql redis]# redis-cli -h 192.168.6.22 -p 7008 -c 
192.168.6.22:7008&gt; get name 
-&gt; Redirected to slot [5798] located at 192.168.6.22:7001
&quot;czqnubilitly&quot;

</code></pre>

<p>-&gt; Redirected to slot [5798] located at 192.168.6.22:7001
OK</p>
<p>==意思是重定向到下节点。==</p>
<h2 id="5">5. 关闭集群</h2>
<p>5.1 关闭本机所有redis</p>
<p><code>pkill redis</code></p>
<p>5.2 关闭具体的redis</p>
<p><code>redis-cli -c -h ${host} -p ${port} shutdown</code></p>
<h2 id="6">6. 检查集群状态</h2>
<p>检查：<code>redis-cli --cluster check ${host}：${port}</code>大致可以看到主从节点，集群的相关信息。</p>
<p>justlike this (5个salve，5个master)</p>
<pre><code class="shell">[root@mysql redis]# redis-cli --cluster check 192.168.6.22:7000
192.168.6.22:7000 (85024884...) -&gt; 0 keys | 3277 slots | 1 slaves.
192.168.6.22:7002 (8968c72d...) -&gt; 0 keys | 3276 slots | 1 slaves.
192.168.6.22:7001 (e3667d6d...) -&gt; 1 keys | 3277 slots | 1 slaves.
192.168.6.22:7003 (6bda2655...) -&gt; 0 keys | 3277 slots | 1 slaves.
192.168.6.22:7004 (0141741a...) -&gt; 0 keys | 3277 slots | 1 slaves.
[OK] 1 keys in 5 masters.
0.00 keys per slot on average.
&gt;&gt;&gt; Performing Cluster Check (using node 192.168.6.22:7000)
M: 8502488405b28ab3b27a758e42a2a7d9da48ba7e 192.168.6.22:7000
   slots:[0-3276] (3277 slots) master
   1 additional replica(s)
S: a4fa88c4b68e71ece93301e9ece010ea0409a030 192.168.6.22:7008
   slots: (0 slots) slave
   replicates 8968c72d7e5fb74b613aa88b84c13b1a3f44c962
M: 8968c72d7e5fb74b613aa88b84c13b1a3f44c962 192.168.6.22:7002
   slots:[6554-9829] (3276 slots) master
   1 additional replica(s)
M: e3667d6d0198b6752e3cb3d6b871cc33e6412b1b 192.168.6.22:7001
   slots:[3277-6553] (3277 slots) master
   1 additional replica(s)
M: 6bda2655347d4b1c8c36c1ed6db5a87182fe2ff4 192.168.6.22:7003
   slots:[9830-13106] (3277 slots) master
   1 additional replica(s)
S: a9deae248772d6f2a5394ec13ef400fc8677a06c 192.168.6.22:7009
   slots: (0 slots) slave
   replicates e3667d6d0198b6752e3cb3d6b871cc33e6412b1b
S: 01d2e5071b46238852c787f4332ab202af6083d7 192.168.6.22:7006
   slots: (0 slots) slave
   replicates 8502488405b28ab3b27a758e42a2a7d9da48ba7e
S: f461a834fbdb5672bdc42ffbc8ace4b3c2e792f1 192.168.6.22:7005
   slots: (0 slots) slave
   replicates 6bda2655347d4b1c8c36c1ed6db5a87182fe2ff4
S: c96310489b156de259ff63a2d86963250e5c9c78 192.168.6.22:7007
   slots: (0 slots) slave
   replicates 0141741ad8c2e10ea9202b658b3ac056d8968306
M: 0141741ad8c2e10ea9202b658b3ac056d8968306 192.168.6.22:7004
   slots:[13107-16383] (3277 slots) master
   1 additional replica(s)
[OK] All nodes agree about slots configuration.
&gt;&gt;&gt; Check for open slots...  
&gt;&gt;&gt; Check slots coverage...
[OK] All 16384 slots covered.

</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>CallMe:Byyelang@gmail.com</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
